{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/js/gallery-randomizer.js","../src/main.js"],"sourcesContent":["export const createMarkup = images => {\n  return images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n      <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n        </a>\n        <div class=\"thumb-block\">\n          <div class=\"block\"><h2 class=\"title\">Likes</h2><p class=\"amount\">${likes}</p></div>\n          <div class=\"block\"><h2 class=\"title\">Views</h2><p class=\"amount\">${views}</p></div>\n          <div class=\"block\"><h2 class=\"title\">Comments</h2><p class=\"amount\">${comments}</p></div>\n          <div class=\"block\"><h2 class=\"title\">Downloads</h2><p class=\"amount\">${downloads}</p></div>\n        </div>\n      </li>`\n    )\n    .join('');\n};\n","import axios from 'axios';\n\nconst API_KEY = '49342840-003e2c292237fbf09de0074d9';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function getPictures(query, page = 1) {\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 15,\n        page: page, // Добавляем параметр страницы\n      },\n    });\n    return response.data;\n  } catch (error) {\n    throw new Error(error.response?.data?.message || 'Failed to fetch images');\n  }\n}\n","function randomizeGalleryItems() {\n  const galleryItems = document.querySelectorAll('.gallery-item');\n  const sizes = ['size-small', 'size-wide', 'size-tall'];\n\n  galleryItems.forEach(item => {\n    item.classList.forEach(className => {\n      if (className.startsWith('size-')) {\n        item.classList.remove(className);\n      }\n    });\n\n    const randomSize = sizes[Math.floor(Math.random() * sizes.length)];\n    item.classList.add(randomSize);\n  });\n}\n\nexport { randomizeGalleryItems };\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport { createMarkup } from './js/render-functions';\nimport { getPictures } from './js/pixabay-api';\nimport { randomizeGalleryItems } from './js/gallery-randomizer';\n\nconst formSearch = document.querySelector('.form');\nconst listImages = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst btnLoadMore = document.querySelector('.btn2');\n\n// Глобальные переменные для пагинации и запроса\nlet page = 1;\nlet query = '';\nconst perPage = 20; // Соответствует параметру per_page в getPictures\n\nloader.style.display = 'none';\nbtnLoadMore.classList.add('is-hidden'); // Скрываем кнопку изначально\n\nfunction showLoader() {\n  loader.style.display = 'block';\n}\n\nfunction hideLoader() {\n  loader.style.display = 'none';\n}\n\nfunction updateGradient(hasImages) {\n  document.body.style.backgroundImage = hasImages\n    ? `linear-gradient(rgba(46, 47, 66, 0.8), rgba(46, 47, 66, 0.8)), url(/img/1.webp)`\n    : `linear-gradient(rgba(46, 47, 66, 0.3), rgba(46, 47, 66, 0.3)), url(/img/1.webp)`;\n}\n\nasync function onSearch(event) {\n  event.preventDefault();\n  listImages.innerHTML = '';\n  showLoader();\n  btnLoadMore.classList.add('is-hidden'); // Скрываем кнопку перед новым поиском\n\n  query = event.target.elements['search-text'].value.trim();\n  page = 1; // Сбрасываем страницу на первую\n\n  if (!query) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Input cannot be empty!',\n      color: '#ff0000',\n    });\n    hideLoader();\n    return;\n  }\n\n  try {\n    const data = await getPictures(query, page);\n    hideLoader();\n\n    if (!data.hits.length) {\n      iziToast.error({\n        title: 'Error',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      updateGradient(false); // Возвращаем исходный градиент\n      return;\n    }\n\n    listImages.innerHTML = createMarkup(data.hits);\n    randomizeGalleryItems();\n    updateGradient(true); // Устанавливаем плотный градиент\n\n    const lightbox = new SimpleLightbox('.gallery a', {\n      captions: true,\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n    lightbox.refresh();\n\n    // Проверяем, есть ли ещё изображения для загрузки\n    if (data.totalHits > page * perPage) {\n      btnLoadMore.classList.remove('is-hidden');\n    }\n\n    formSearch.reset();\n  } catch (error) {\n    hideLoader();\n    iziToast.error({ title: 'Error', message: error.message });\n    updateGradient(false); // Возвращаем исходный градиент при ошибке\n  }\n}\n\nasync function onLoadMore(event) {\n  showLoader();\n  page++;\n\n  try {\n    const data = await getPictures(query, page);\n    hideLoader();\n\n    if (!data.hits.length || data.hits.length < perPage) {\n      btnLoadMore.classList.add('is-hidden');\n      btnLoadMore.removeEventListener('click', onLoadMore);\n      iziToast.info({\n        title: 'Info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n\n    listImages.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n    randomizeGalleryItems();\n    updateGradient(true); // Поддерживаем плотный градиент\n\n    const lightbox = new SimpleLightbox('.gallery a', {\n      captions: true,\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n    lightbox.refresh();\n  } catch (error) {\n    hideLoader();\n    iziToast.error({ title: 'Error', message: error.message });\n    updateGradient(false); // Возвращаем исходный градиент при ошибке\n  }\n}\n\nformSearch.addEventListener('submit', onSearch);\nbtnLoadMore.addEventListener('click', onLoadMore);\n"],"names":["createMarkup","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","API_KEY","BASE_URL","getPictures","query","page","axios","error","_b","_a","randomizeGalleryItems","galleryItems","sizes","item","className","randomSize","formSearch","listImages","loader","btnLoadMore","perPage","showLoader","hideLoader","updateGradient","hasImages","onSearch","event","iziToast","data","SimpleLightbox","onLoadMore"],"mappings":"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"}